# Checking pixel logic
# check from rightest to the left to see if there is a green or red candle


#### Pending: 
Minute photo cap logic 


Steps:
1. Run extract_hex_colors.py to find the matched color.
2. Input the matched color then run search_specific_color.py, to check whenther the color is right or not.



### run strategy.py to start the strategy


### add the zigzag indicator 

#Steps:
1. Open scrape.py, open NVDA, TSLA etc.
2. 每5 min 整分鐘 - 30s 就refresh all tabs, then > 5分鐘整就 capture all tabs photos.
3. Save the photo in a proper dir, open ${number of photo captured} threading.
3. Input the photo for the strategy, output the signal.


??? 跟PID or what?
### alert -done
### logging -done
### close tab then reopen again at 5-30s... not refresh only
### auto start logic.
### all three - > 1.0 confidence buy
### only two -> 0.5 confidence to buy (zigzag + ???)
#### only open new tabs -30s, and then refresh only at 00.


## not enought candle i.e. image width too short.
***** 問號，係咪indicator 會update 快過 00整點即refresh一次之後再cap
***** 問號 90 pixel too long? Maybe can set shorter (AB=CD is 90pixel, but the longer then easier to reach)
### Check the time for checking the 賣吾賣order 耐吾耐

***** check the program 有冇bug
*** 10 tabs, 要令到last two no delay


### fabaci too big, chcek the stop loss and take profit. - done
### daily close having problem - done
New logic -> start a pool of keep getting the current price. - work
self.ib -> use the same connection with the current price.




####Add the proper last candle stop loss/ take profit.



get the last 20 bar lowest value 
get the last 20 bar highest value
recent_low = last20bar.close.min()
recent_high = last20bar.close.max()
risk_long = current_price - recent_low
Fib_SL_long = 0.382 + (1 - confidence_bull) * (0.618 - 0.382)
Fib_TP_long = 1.382 + confidence_bull * (1.618 - 1.382)
SL_long = current_price - risk_long * Fib_SL_long
TP_long = current_price + risk_long * Fib_TP_long

risk_short = recent_high - current_price
Fib_SL_short = 0.382 + (1 - confidence_bear) * (0.618 - 0.382)
Fib_TP_short = 1.382 + confidence_bear * (1.618 - 1.382)
SL_short = current_price + risk_short * Fib_SL_short
TP_short = current_price - risk_short * Fib_TP_short
get the client_id from a global list, atomic action to get and pop a element from it. 